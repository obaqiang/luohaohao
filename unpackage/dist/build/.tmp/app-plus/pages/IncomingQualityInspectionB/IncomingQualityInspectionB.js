(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/IncomingQualityInspectionB/IncomingQualityInspectionB"],{"0509":function(t,e,a){"use strict";a("72e6");var n=i(a("b0ce")),o=i(a("e41d"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(o.default))},3907:function(t,e,a){"use strict";var n=a("d5ee"),o=a.n(n);o.a},5074:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticStyle:{"text-align":"center"},attrs:{type:"number",eventid:"38e9233a-0"},domProps:{value:t.val},on:{input:[function(e){e.target.composing||(t.val=e.target.value)},t.intInput]}})])},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},"52af":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("3bd3")),o=s(a("6a28")),i=a("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){l(t,e,a[e])})}return t}function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r={props:["send_data","send_choose_stand","show_table_data","default_result","err_code_table_items"],components:{IncomingQualityInspectionBTable:n.default,errInput:o.default},data:function(){return{num_a:"",num_b:"",num_c:"",num_d:"",check_ok:!1,return_data:{},seq:"",choose_stand:this.send_choose_stand,cal_err_code_table_items:this.err_code_table_items}},computed:{i18n:function(){return this.$t("IncomingQualityInspection")},receiveQty:function(){return null==t.getStorageSync("qualityInspection_data").receiveQty?0:t.getStorageSync("qualityInspection_data").receiveQty},sampleQty:function(){return null==t.getStorageSync("qualityInspection_data").sampleQty?0:t.getStorageSync("qualityInspection_data").sampleQty},qcLevel:function(){return null==t.getStorageSync("qualityInspection_data").qcLevel?0:t.getStorageSync("qualityInspection_data").qcLevel},rejectQtyStand:function(){return t.getStorageSync("rejectQtyStand")},rejectQty:function(){return null==t.getStorageSync("qualityInspection_data").rejectQty?0:t.getStorageSync("qualityInspection_data").rejectQty},NGQty:function(){return null==t.getStorageSync("qualityInspection_data").ngQty?0:t.getStorageSync("qualityInspection_data").ngQty},IncomingQualityInspectionB_table_data:function(){return this.send_data},sampleQty_in_table:function(){return this.send_data.length},NGQty_in_table:function(){for(var t=this.send_data,e=0,a=0;a<t.length;a++)3==t[a].result&&(e+=1);return e},fatalQty_all:function(){for(var t=this.send_data,e=0,a=0;a<t.length;a++)e+=t[a].fatalQty;return e},seriousQty_all:function(){for(var t=this.send_data,e=0,a=0;a<t.length;a++)e+=t[a].seriousQty;return e},commonlyQty_all:function(){for(var t=this.send_data,e=0,a=0;a<t.length;a++)e+=t[a].commonlyQty;return e},slightQty_all:function(){for(var t=this.send_data,e=0,a=0;a<t.length;a++)e+=t[a].slightQty;return e},qcResult:function(){return t.getStorageSync("qualityInspection_data").qcResult}},watch:{default_result:{handler:function(t,e){1==t?this.check_ok=!0:3==t&&(this.check_ok=!1)},immediate:!0},sampleQty:{handler:function(t,e){0==this.show_table_data&&(this.num_a=t)},immediate:!0},rejectQty:{handler:function(t,e){0==this.show_table_data&&(this.num_b=t)},immediate:!0},NGQty:{handler:function(t,e){0==this.show_table_data&&(this.num_c=t)},immediate:!0},show_table_data:{handler:function(t,e){},immediate:!0},send_data:{handler:function(t,e){1==this.show_table_data&&(12==this.qcLevel?(this.num_a=this.sampleQty_in_table,this.num_c=this.NGQty_in_table):22==this.qcLevel&&(this.num_c=this.NGQty_in_table)),this.num_d=this.Percentage(this.num_c,this.num_a)},immediate:!0}},methods:c({},(0,i.mapMutations)(["initPosition"]),{Percentage:function(t,e){return e<0||0==e?0:t<0?0:Math.round(t/e*1e4)/100+"%"},woCao:function(){console.log(this.IncomingQualityInspectionB_table_data)},longPress:function(t){this.$emit("longPress",t)},calNumA:function(t){this.num_a=t.detail.value,0==this.num_a||(this.num_d=this.Percentage(this.num_c,this.num_a))},calNumB:function(t){this.num_b=t.detail.value},calNumC:function(t){this.num_c=t.detail.value,this.num_d=this.Percentage(this.num_c,this.num_a),22==this.qcLevel&&(this.rejectQtyStand>this.num_c||this.rejectQtyStand==this.num_c?this.check_ok=!0:this.check_ok=!1)},chooseStand:function(t){this.choose_stand=t,this.$emit("chooseStand",t)},intInput:function(t){var e=this;console.log("wocao "),console.log(t),console.log(e.err_code_table_items),e.cal_err_code_table_items=e.err_code_table_items;for(var a=0;a<e.cal_err_code_table_items.length;a++)t.err_code==e.cal_err_code_table_items[a].errorCode&&(e.cal_err_code_table_items[a].qcValue=t.value,e.$emit("intInput",e.cal_err_code_table_items))},plusNewModal:function(){var e=this,a=/^[0-9]*[1-9][0-9]*$/;if(a.test(e.seq)){for(var n=e.IncomingQualityInspectionB_table_data,o=!1,i=0;i<n.length;i++)e.seq==n[i].seq&&(o=!0);""==e.seq?t.showToast({icon:"none",title:e.i18n.QualityInspectionOperationB_q,duration:2e3}):1==o?t.showToast({icon:"none",title:e.i18n.QualityInspectionOperationB_r,duration:2e3}):(e.$emit("plusNewModal",e.seq),e.initPosition())}else t.showToast({icon:"none",title:e.i18n.showToast_new,duration:2e3})},subMit:function(){var t=this;t.return_data.SampleQty=t.num_a,t.return_data.RejectQty=t.num_b,t.return_data.NGQty=t.num_c,t.$emit("subMit",t.return_data)}})};e.default=r}).call(this,a("6e42")["default"])},"6a28":function(t,e,a){"use strict";a.r(e);var n=a("5074"),o=a("eb48");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);var s=a("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},"7b5c":function(t,e,a){"use strict";var n=a("931f"),o=a.n(n);o.a},"7e96":function(t,e,a){"use strict";a.r(e);var n=a("fc9f"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},8644:function(t,e,a){"use strict";a.r(e);var n=a("fa6a"),o=a("7e96");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("7b5c");var s=a("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},"931f":function(t,e,a){},a0bc:function(t,e,a){"use strict";a.r(e);var n=a("52af"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},a28a:function(t,e,a){"use strict";a.r(e);var n=a("fdb20"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},b272:function(t,e,a){"use strict";var n;function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("2f62");var i=(n={props:["err_code","qcValue"],components:{},data:function(){return{val:this.qcValue}},computed:{},watch:{},onNavigationBarButtonTap:function(){}},o(n,"computed",{}),o(n,"methods",{intInput:function(t){var e={};e.err_code=this.err_code,e.value=t.detail.value,this.$emit("intInput",e)}}),o(n,"onLoad",function(){}),n);e.default=i},b577:function(t,e,a){"use strict";var n=a("daa1"),o=a.n(n);o.a},d5ee:function(t,e,a){},daa1:function(t,e,a){},e41d:function(t,e,a){"use strict";a.r(e);var n=a("f702"),o=a("a28a");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("b577");var s=a("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports},e907:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"QualityInspectionOperation_area"},[a("view",{staticClass:"QualityInspectionOperation_title"},[t._v(t._s(t.i18n.QualityInspectionOperationB_a))]),a("view",{staticClass:"QualityInspectionOperation_in"},[a("view",{staticClass:"QualityInspectionOperation_in_list"},[a("text",[t._v(t._s(t.i18n.QualityInspectionOperationB_c))]),12==t.qcLevel?a("input",{directives:[{name:"model",rawName:"v-model",value:t.num_a,expression:"num_a"}],staticClass:"QualityInspectionOperation_input",attrs:{type:"number",eventid:"ebcbf4be-0"},domProps:{value:t.num_a},on:{input:[function(e){e.target.composing||(t.num_a=e.target.value)},t.calNumA]}}):t._e(),22==t.qcLevel?a("text",{staticClass:"QualityInspectionOperation_in_list_text"},[t._v(t._s(t.num_a))]):t._e()]),a("view",{staticClass:"QualityInspectionOperation_in_list"},[a("text",[t._v(t._s(t.i18n.QualityInspectionOperationB_d))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.num_b,expression:"num_b"}],staticClass:"QualityInspectionOperation_input",attrs:{type:"number",eventid:"ebcbf4be-1"},domProps:{value:t.num_b},on:{input:[function(e){e.target.composing||(t.num_b=e.target.value)},t.calNumB]}})])]),a("view",{staticClass:"QualityInspectionOperation_in"},[a("view",{staticClass:"QualityInspectionOperation_in_list"},[a("text",[t._v(t._s(t.i18n.QualityInspectionOperationB_e))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.num_c,expression:"num_c"}],staticClass:"QualityInspectionOperation_input",attrs:{type:"number",eventid:"ebcbf4be-2"},domProps:{value:t.num_c},on:{input:[function(e){e.target.composing||(t.num_c=e.target.value)},t.calNumC]}})]),a("view",{staticClass:"QualityInspectionOperation_in_list"},[a("text",[t._v(t._s(t.i18n.QualityInspectionOperationB_f))]),a("text",{staticClass:"QualityInspectionOperation_in_list_text"},[t._v(t._s(t.num_d))])])]),a("view",{staticClass:"err_code_table"},[t._m(0),t._l(t.err_code_table_items,function(e,n){return a("view",{key:n,staticClass:"err_code_body"},[a("text",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.errorCode))]),a("text",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.errorName))]),a("errInput",{staticStyle:{width:"30%"},attrs:{qcValue:e.qcValue,err_code:e.errorCode,eventid:"ebcbf4be-3-"+n,mpcomid:"ebcbf4be-0-"+n},on:{intInput:t.intInput}})],1)})],2),a("view",{staticClass:"QualityInspectionOperation_foot"},[a("text",[t._v(t._s(t.i18n.quality_result))]),a("text",{class:{QualityInspectionOperation_foot_on:1==t.send_choose_stand},attrs:{eventid:"ebcbf4be-4"},on:{tap:function(e){t.chooseStand(1)}}},[t._v(t._s(t.i18n.QualityInspectionOperationB_m))]),a("text",{class:{QualityInspectionOperation_foot_on:3==t.send_choose_stand},attrs:{eventid:"ebcbf4be-5"},on:{tap:function(e){t.chooseStand(3)}}},[t._v(t._s(t.i18n.QualityInspectionOperationB_o))])]),2==t.qcResult?a("view",{staticClass:"common_bot_btn",attrs:{eventid:"ebcbf4be-6"},on:{tap:t.subMit}},[t._v(t._s(t.i18n.QualityInspectionOperationB_p))]):t._e()])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"err_code_head"},[a("text",[t._v("不良代码")]),a("text",[t._v("不良名称")]),a("text",[t._v("不良数")])])}];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},eb48:function(t,e,a){"use strict";a.r(e);var n=a("b272"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},f702:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",[a("MaterialInformation",{attrs:{mpcomid:"b16866bc-0"}}),a("AcceptanceStandard",{attrs:{mpcomid:"b16866bc-1"}}),a("QualityInspectionOperationB",{attrs:{send_data:t.IncomingQualityInspectionB_table_data,send_choose_stand:t.QCResult,show_table_data:t.show_table_data,detault_result:t.detault_result,err_code_table_items:t.err_code_table_items,eventid:"b16866bc-0",mpcomid:"b16866bc-2"},on:{longPress:t.longPress,subMit:t.subMit,plusNewModal:t.plusNewModal,errList:t.errList,chooseStand:t.chooseStand,intInput:t.intInput}}),t.modal_show?a("IncomingQualityInspectionBPlusModal",{attrs:{modal_index:t.modal_index,modal_num:t.modal_num,seq:t.seq,reason_send:t.reason,IncomingQualityInspectionBPlusModal_data_show:t.IncomingQualityInspectionBPlusModal_data_show,change_result:t.change_result,change_errorCodeId:t.change_errorCodeId,submit_status:t.submit_status,change_test_data:t.change_test_data,eventid:"b16866bc-1",mpcomid:"b16866bc-3"},on:{closeModal:t.closeModal,showModalBtn:t.showModalBtn,choCheck:t.choCheck,bindPickerChange:t.bindPickerChange,testConfirm:t.testConfirm}}):t._e(),t.loading_wait_show?a("loadingWait",{attrs:{mpcomid:"b16866bc-4"}}):t._e()],1)},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},fa6a:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",[a("view",{staticClass:"RecordModal_show_modal_mask"}),a("view",{staticClass:"RecordModal_show_modal_area"},[a("view",{staticClass:"RecordModal_show_modal_header"},[t._v("设置")]),a("view",{staticClass:"RecordModal_show_modal_body"},[a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("样品编号:")]),a("text",[t._v(t._s(t.seq_show))])]),a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("检验项目:")]),a("text",[t._v(t._s(t.checkItemName))])]),a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("检验方式:")]),a("text",[t._v(t._s(t.judgeType))])]),"Value"==t.resultType?a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("测量值:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.test_data,expression:"test_data"}],staticClass:"RecordModal_show_modal_body_list_input",attrs:{type:"number",eventid:"26e02d01-0"},domProps:{value:t.test_data},on:{input:[function(e){e.target.composing||(t.test_data=e.target.value)},t.testConfirm]}})]):t._e(),"Value"==t.resultType?a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("范围:")]),a("text",[t._v(t._s(t.limitLow)+"~"+t._s(t.limitHigh)+"("+t._s(t.unit)+")")])]):t._e(),a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("质检结果:")]),a("view",{staticClass:"RecordModal_show_modal_body_list_new"},[a("text",{class:{IncomingQualityInspectionBPlusModal_ok:t.check_ok},attrs:{eventid:"26e02d01-1"},on:{tap:function(e){t.choCheck(!0)}}},[t._v("合格")]),a("text",{class:{IncomingQualityInspectionBPlusModal_ok:0==t.check_ok},attrs:{eventid:"26e02d01-2"},on:{tap:function(e){t.choCheck(!1)}}},[t._v("不合格")])])]),0==t.check_ok?a("view",{staticClass:"RecordModal_show_modal_body_list"},[a("text",[t._v("不良原因:")]),""!=t.reason?a("picker",{staticClass:"IncomingQualityInspectionBPlusModal_picker",attrs:{value:t.index,range:t.reason,"range-key":"errorName",eventid:"26e02d01-3"},on:{change:t.bindPickerChange}},[a("view",{staticClass:"uni-input"},[t._v(t._s(t.reason[t.index].errorName))])]):t._e()],1):t._e()]),a("view",{staticClass:"RecordModal_show_modal_footer"},[0!=t.modal_index?a("button",{staticClass:"RecordModal_show_modal_footer_btn_left_b",attrs:{eventid:"26e02d01-4"},on:{tap:function(e){t.showModalBtn(0)}}},[t._v("上一步")]):t._e(),t.modal_num>1?a("button",{staticClass:"RecordModal_show_modal_footer_btn_left_b",attrs:{eventid:"26e02d01-5"},on:{tap:function(e){t.showModalBtn(1)}}},[t._v("下一步")]):t._e(),2==t.qcResult?a("button",{staticClass:"RecordModal_show_modal_footer_btn_left_c",attrs:{eventid:"26e02d01-6"},on:{tap:function(e){t.showModalBtn(2)}}},[t._v("保存")]):t._e()],1),a("image",{staticClass:"ali_close_icon",attrs:{src:t.ali_close_icon,eventid:"26e02d01-7"},on:{tap:t.closeModal}})])])},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},fc9f:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a("2f62");function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){i(t,e,a[e])})}return t}function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var s={props:["IncomingQualityInspectionBPlusModal_data_show","reason_send","seq","modal_index","modal_num","change_result","change_errorCodeId","change_test_data","submit_status"],components:{},watch:{seq:{handler:function(t,e){console.log("得到的seq:"+t)},immediate:!0},IncomingQualityInspectionBPlusModal_data_show:{handler:function(t,e){console.log(t)},immediate:!0},reason_send:{handler:function(t,e){var a=[],n={defectGrade:"",errorCode:"",errorName:"请选择",id:""};a.push(n);for(var o=0;o<t.length;o++){var i=t[o];a.push(i)}console.log(a),this.reason=a},immediate:!0},change_result:{handler:function(t,e){"change"==this.submit_status&&(this.check_ok=t)},immediate:!0},change_errorCodeId:{handler:function(t,e){if("change"==this.submit_status){this.index=0;for(var a=0;a<this.reason.length;a++)t==this.reason[a].id&&(this.index=a)}},immediate:!0},change_test_data:{handler:function(t,e){"change"==this.submit_status&&(this.test_data=t)},immediate:!0}},data:function(){return{ali_close_icon:"../../static/img/ali_close_icon.png",new_data_f:this.data_f,new_data_g:this.data_g,focus_a:!1,focus_b:!1,index:0,check_ok:!0,test_data:"",defectGrade:"",errorCodeId:"",errorName:"",checkItemId_show:this.checkItemId,seq_show:this.seq,reason:""}},computed:{i18n:function(){return this.$t("RecordModal")},checkItemName:function(){return this.IncomingQualityInspectionBPlusModal_data_show.checkItemName},judgeType:function(){return"1"==this.IncomingQualityInspectionBPlusModal_data_show.judgeType?"自动判断":"2"==this.IncomingQualityInspectionBPlusModal_data_show.judgeType?"人工判断":void 0},unit:function(){return this.IncomingQualityInspectionBPlusModal_data_show.unit},limitHigh:function(){return this.IncomingQualityInspectionBPlusModal_data_show.limitHigh},limitLow:function(){return this.IncomingQualityInspectionBPlusModal_data_show.limitLow},checkItemId:function(){return this.IncomingQualityInspectionBPlusModal_data_show.checkItemId},resultType:function(){return this.IncomingQualityInspectionBPlusModal_data_show.resultType},qcResult:function(){return t.getStorageSync("qualityInspection_data").qcResult}},methods:o({},(0,n.mapMutations)(["initPosition"]),{testConfirm:function(t){var e=this;e.test_data=t.detail.value,""==e.test_data||e.test_data<e.limitLow||e.test_data>e.limitHigh?e.choCheck(!1):e.choCheck(!0),e.$emit("testConfirm",e.test_data)},choCheck:function(t){this.check_ok=t,0==t?this.$emit("choCheck",this.checkItemId):this.$emit("choCheck",t)},bindPickerChange:function(t){this.index=t.detail.value,this.$emit("bindPickerChange",this.reason[this.index])},initFocus:function(){this.focus_a=!1,this.focus_b=!1},initModalData:function(){console.log("进入初始化"),this.test_data="",this.check_ok=!0,this.index=0,this.defectGrade="",this.errorCodeId="",this.errorName=""},calBindChangeInfo:function(t){var e=this,a=this.reason;console.log(a);var n={};for(var o in a)o==t&&(n.defectGrade=a[t].defectGrade,n.errorCodeId=a[t].id,n.errorName=a[t].errorName,n.checkItemId=e.checkItemId,n.seq=e.seq_show);return n},showModalBtn:function(e){var a=this;if(0==e){a.initModalData();var n=t.getStorageSync("modal_data_user_cho");for(var o in console.log("点击上一步"),console.log(n),n)console.log(o),console.log(a.modal_index),o==a.modal_index-1&&(console.log(o),a.test_data=n[o].test_data,a.check_ok=n[o].check_ok,a.index=n[o].index,a.info=a.calBindChangeInfo(a.index))}else if(1==e){console.log("点击下一步"),console.log(a.submit_status);var i=[];0==a.modal_index||(i=t.getStorageSync("modal_data_user_cho"));var s={};s.test_data=a.test_data,s.check_ok=a.check_ok,s.index=a.index,s.info=a.calBindChangeInfo(a.index),i.push(s),t.setStorageSync("modal_data_user_cho",i),"change"==a.submit_status||"submit"==a.submit_status&&a.initModalData()}else if(2==e)if(0==a.modal_index){var c=[],l={};l.test_data=a.test_data,l.check_ok=a.check_ok,l.index=a.index,l.info=a.calBindChangeInfo(a.index),c.push(l),t.setStorageSync("modal_data_user_cho",c)}else{var r=[],u=t.getStorageSync("modal_data_user_cho");for(var d in u)if(d<a.modal_index+1){var _={};_.test_data=u[d].test_data,_.check_ok=u[d].check_ok,_.index=u[d].index,_.info=a.calBindChangeInfo(_.index),r.push(_)}var m={};m.test_data=a.test_data,m.check_ok=a.check_ok,m.index=a.index,m.info=a.calBindChangeInfo(a.index),u.push(m),t.setStorageSync("modal_data_user_cho",u),console.log(t.getStorageSync("modal_data_user_cho"))}a.$emit("showModalBtn",e)},focusInput:function(){this.new_data_f=""},initInput:function(){this.initPosition()},confirmInput:function(){this.initFocus(),this.focus_b=!0},closeModal:function(){this.$emit("closeModal",!0)}}),onLoad:function(){}};e.default=s}).call(this,a("6e42")["default"])},fdb20:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("99a6")),o=r(a("fbdb")),i=r(a("6dd3")),s=r(a("ff97")),c=r(a("8644")),l=a("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),n.forEach(function(e){d(t,e,a[e])})}return t}function d(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var _={components:{MaterialInformation:n.default,QualityInspectionOperationB:s.default,AcceptanceStandard:i.default,IncomingQualityInspectionBPlusModal:c.default,loadingWait:o.default},data:function(){return{QCResult:"",fatalQty_all:"",seriousQty_all:"",commonlyQty_all:"",slightQty_all:"",modal_num:0,modal_num_max:"",modal_index:0,modal_show:!1,IncomingQualityInspectionBPlusModal_data_show:"",IncomingQualityInspectionBPlusModal_data:"",CheckItemId:"",reason:"",detault_result:"",Items:[],seq:"",test_data:"",errorCodeId:"",errorName:"",defectGrade:"",Result:1,IncomingQualityInspectionB_table_data:"",SampleId:"",ngQty:0,submit_status:"submit",show_table_data:!1,SampleQty_to_submit:this.SampleQty,NGQty_to_submit:this.NGQty,RejectQty_to_submit:this.rejectQty,Items_change:"",change_result:"",change_errorCodeId:"",change_test_data:"",err_code_table_items:"",loading_wait_show:!1}},computed:{connect_url:function(){return this.$store.state.connect_url},post_header:function(){return this.$store.state.post_header},i18n:function(){return this.$t("IncomingQualityInspection")},MAC:function(){return this.$store.state.MAC},Id:function(){return t.getStorageSync("qualityInspection_data").id},SampleQty:function(){return t.getStorageSync("qualityInspection_data").sampleQty},billDetailId:function(){return t.getStorageSync("qualityInspection_data").billDetailId},materialId:function(){return t.getStorageSync("qualityInspection_data").materialId},SampleCode:function(){return t.getStorageSync("qualityInspection_data").sampleCode},rejectQtyStand:function(){return t.getStorageSync("rejectQtyStand")},qcLevel:function(){return t.getStorageSync("qualityInspection_data").qcLevel},rejectQty:function(){return null==t.getStorageSync("qualityInspection_data").rejectQty?0:t.getStorageSync("qualityInspection_data").rejectQty},qcResult:function(){return t.getStorageSync("qualityInspection_data").qcResult},NGQty:function(){return null==t.getStorageSync("qualityInspection_data").NGQty?0:t.getStorageSync("qualityInspection_data").NGQty}},watch:{ngQty:{handler:function(t,e){var a=this;a.rejectQtyStand>t||a.rejectQtyStand==t?(a.QCResult=1,console.log(a.QCResult)):(a.QCResult=3,console.log(a.QCResult))},immediate:!0}},methods:u({},(0,l.mapMutations)(["MacInfo"]),(0,l.mapMutations)(["initPosition"]),(0,l.mapMutations)(["changeToken"]),(0,l.mapMutations)(["changeOrgId"]),(0,l.mapMutations)(["ErrRequestShow"]),{closeModal:function(){this.modal_show=!1,this.Items="",this.Items_change="",t.setStorageSync("modal_data_user_cho",""),this.modal_index=0,this.modal_num=this.modal_num_max},changengQty:function(){this.ngQty+=10},calngQty:function(){for(var t=this.IncomingQualityInspectionB_table_data,e=0,a=0;a<t.length;a++)e+=t[a].fatalQty;for(var n=0,o=0;o<t.length;o++)n+=t[o].seriousQty;for(var i=0,s=0;s<t.length;s++)i+=t[s].commonlyQty;for(var c=0,l=0;l<t.length;l++)c+=t[l].slightQty;this.ngQty=e+n+i+c},chooseStand:function(t){console.log(t),this.QCResult=t},longPress:function(e){console.log(e);var a=this;for(var n in a.SampleId=e,a.initItemsChangeData(),a.GetIqcDetails(),console.log(a.IncomingQualityInspectionB_table_data),a.IncomingQualityInspectionB_table_data)e==a.IncomingQualityInspectionB_table_data[n].id&&(a.seq=a.IncomingQualityInspectionB_table_data[n].seq,console.log(a.seq));2==a.qcResult?t.showActionSheet({itemList:a.i18n.itemList,success:function(e){0==e.tapIndex?t.showModal({title:a.i18n.modal_text_a,content:a.i18n.modal_text_b,success:function(t){t.confirm?(console.log("用户点击确定"),a.DeleteIqcSamples()):t.cancel&&console.log("用户点击取消")}}):1==e.tapIndex&&(a.modal_show=!0,a.submit_status="change",a.changeShowModalData())},fail:function(t){console.log(t.errMsg)}}):t.showActionSheet({itemList:["查看"],success:function(t){console.log("选中了第"+(t.tapIndex+1)+"个按钮"),0==t.tapIndex&&(a.modal_show=!0,a.submit_status="change",a.changeShowModalData())},fail:function(t){console.log(t.errMsg)}})},SaveIqcNormal1:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/SaveIqcNormal1",data:{MAC:e.MAC,Id:e.Id,SampleQty:e.SampleQty_to_submit,NGQty:e.NGQty_to_submit,RejectQty:e.RejectQty_to_submit,QCResult:e.QCResult},method:"POST",header:e.post_header,success:function(a){console.log(a.data),e.loading_wait_show=!1,e.ErrRequestShow(a),1==a.data.success&&(t.showToast({icon:"none",title:"提交成功",duration:2e3}),setTimeout(function(){t.navigateBack({})},2e3))}})},GetIqcSamples:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/GetIqcSamples",data:{MAC:e.MAC,BillDetailId:e.billDetailId},method:"POST",header:e.post_header,success:function(t){console.log("wocao "),console.log(t.data),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success&&(e.IncomingQualityInspectionB_table_data=t.data.result.items,e.calngQty())}})},GetMaterialCheckItems2:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/GetMaterialCheckItems2",data:{MAC:e.MAC,MaterialId:e.materialId},method:"POST",header:e.post_header,success:function(t){if(console.log("获取到的检验项目"),console.log(t.data),console.log(JSON.stringify(t.data)),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success){for(var a=t.data.result.items,n=0;n<a.length;n++)a[n].ERRQTY="";e.err_code_table_items=a}}})},GetMaterialCheckItems:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/GetMaterialCheckItems",data:{MAC:e.MAC,MaterialId:e.materialId},method:"POST",header:e.post_header,success:function(t){console.log("获取到的检验项目"),console.log(t.data),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success&&(e.CheckItemId=t.data.result.items[0].checkItemId,e.GetItemErrorCode())}})},GetItemErrorCode:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/GetItemErrorCode",data:{MAC:e.MAC,CheckItemId:e.CheckItemId,billDetailId:t.getStorageSync("qualityInspection_data").billDetailId},method:"POST",header:e.post_header,success:function(t){if(console.log(t.data),console.log(JSON.stringify(t.data)),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success){e.reason=t.data.result.items,e.err_code_table_items=t.data.result.items;var a=t.data.result.items;e.err_code_table_items=a}}})},CreateIqcSamples:function(){var e=this;e.loading_wait_show=!0,e.show_table_data=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/CreateIqcSamples",data:{MAC:e.MAC,BillDetailId:e.billDetailId,Seq:e.seq,Result:e.Result,Items:e.Items},method:"POST",header:e.post_header,success:function(t){console.log(t.data);var a={MAC:e.MAC,BillDetailId:e.billDetailId,Seq:e.seq,Result:e.Result,Items:e.Items};console.log(JSON.stringify(a)),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success&&e.SaveIqcNormal1()}})},GetIqcDetails:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/GetIqcDetails",data:{MAC:e.MAC,SampleId:e.SampleId},method:"POST",header:e.post_header,success:function(t){if(e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success)for(var a=t.data.result.items,n=0;n<e.Items_change.length;n++)for(var o=0;o<a.length;o++)n==o&&(e.Items_change[n].id=a[o].id,e.Items_change[n].qcValue=a[o].qcValue,e.Items_change[n].result=a[o].result,e.Items_change[n].errorCodeId=a[o].errorCodeId,e.Items_change[n].defectGrade=a[o].defectGrade)}})},DeleteIqcSamples:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/DeleteIqcSamples",data:{MAC:e.MAC,Id:e.SampleId},method:"POST",header:e.post_header,success:function(t){console.log(t.data),e.loading_wait_show=!1,e.ErrRequestShow(t),1==t.data.success&&e.GetIqcSamples()}})},UpdateIqcSamples:function(){var e=this;e.loading_wait_show=!0,t.request({url:e.connect_url+"api/services/wmspda/Inspection/UpdateIqcSamples",data:{MAC:e.MAC,SampleId:e.SampleId,Result:e.Result,Items:e.Items_change},method:"POST",header:e.post_header,success:function(a){console.log(a.data);var n={MAC:e.MAC,SampleId:e.SampleId,Result:e.Result,Items:e.Items_change};console.log(JSON.stringify(n)),e.loading_wait_show=!1,e.ErrRequestShow(a),1==a.data.success&&(e.modal_index=0,e.modal_num=e.modal_num_max,e.GetIqcSamples(),t.showToast({icon:"none",title:e.i18n.toast_text_a,duration:2e3}),t.setStorageSync("modal_data_user_cho",""))}})},intInput:function(t){console.log("这里"),console.log(t),this.err_code_table_items=t},subMit:function(e){console.log(e);var a=this;a.SampleQty_to_submit=e.SampleQty,a.RejectQty_to_submit=e.RejectQty,a.NGQty_to_submit=e.NGQty;var n=t.getStorageSync("qualityInspection_data");console.log(n),console.log(a.err_code_table_items),a.seq=1;for(var o=[],i=0;i<a.err_code_table_items.length;i++){var s={billId:n.billId,billDetailId:n.billDetailId,billLine:i,materialId:n.materialId,materialCode:n.materialCode,seq:i,checkItemId:n.checkItemId,qcValue:a.err_code_table_items[i].qcValue,result:a.Result,errorCodeId:"",errorName:a.err_code_table_items[i].errorName,defectGrade:a.err_code_table_items[i].defectGrade};o.push(s)}a.Items=o,a.CreateIqcSamples(),a.submit_status="submit"},plusNewModal:function(t){console.log(t),this.submit_status="submit",this.modal_show=!0,this.seq=t,this.Result=1,this.IncomingQualityInspectionBPlusModal_data_show=this.IncomingQualityInspectionBPlusModal_data[0]},choCheck:function(t){console.log(t),console.log(typeof t),"number"==typeof t&&(this.Result=3,this.CheckItemId=t,this.GetItemErrorCode()),"boolean"==typeof t&&(this.Result=1)},testConfirm:function(t){var e=this;e.test_data=t},bindPickerChange:function(t){this.defectGrade=t.defectGrade,this.errorCodeId=t.id,this.errorName=t.errorName},initItemsData:function(){for(var e=this,a=[],n=0;n<e.IncomingQualityInspectionBPlusModal_data.length;n++){var o={};o.billId=t.getStorageSync("qualityInspection_data").billId,o.billDetailId=t.getStorageSync("qualityInspection_data").billDetailId,o.billLine=t.getStorageSync("qualityInspection_data").billLine,o.materialId=t.getStorageSync("qualityInspection_data").materialId,o.materialCode=t.getStorageSync("qualityInspection_data").materialCode,o.seq="",o.qcValue="",o.result=1,o.errorCodeId="",o.errorName="",o.defectGrade="",o.checkItemId=e.IncomingQualityInspectionBPlusModal_data[n].checkItemId,a.push(o)}e.Items=a},initItemsChangeData:function(){var t=this,e=[];console.log(t.IncomingQualityInspectionBPlusModal_data);for(var a=0;a<t.IncomingQualityInspectionBPlusModal_data.length;a++){var n={id:"",qcValue:""};n.result=n.errorCodeId="",n.defectGrade="",e.push(n)}t.Items_change=e},changeShowModalData:function(){var t=this;t.change_result=!0,t.change_test_data="";for(var e=0;e<t.Items_change.length;e++)e==t.modal_index&&(t.change_test_data=t.Items_change[e].qcValue,1==t.Items_change[e].result?t.change_result=!0:3==t.Items_change[e].result&&(t.change_result=!1));for(var a=0;a<t.IncomingQualityInspectionBPlusModal_data.length;a++)a==t.modal_index&&(t.IncomingQualityInspectionBPlusModal_data_show=t.IncomingQualityInspectionBPlusModal_data[a],t.CheckItemId=t.IncomingQualityInspectionBPlusModal_data[a].checkItemId);t.GetItemErrorCode()},doChange:function(){var e=this,a=t.getStorageSync("modal_data_user_cho"),n=e.Items_change;for(var o in n)for(var i in a)o==i&&(n[o].qcValue=a[i].test_data,1==a[i].check_ok?n[o].result=1:n[o].result=3,n[o].errorCodeId=a[o].info.errorCodeId,n[o].defectGrade=a[o].info.defectGrade);e.Items_change=n},doSave:function(){var e=this;e.initItemsData();var a=t.getStorageSync("modal_data_user_cho"),n=(e.IncomingQualityInspectionBPlusModal_data,e.Items);for(var o in a)for(var i in n)o==i&&(n[i].qcValue=a[o].test_data,n[i].errorCodeId=a[o].info.errorCodeId,n[i].errorName=a[o].info.errorName,"请选择"==n[i].errorName&&(n[i].errorName=""),n[i].defectGrade=a[o].info.defectGrade,n[i].checkItemId=a[o].info.checkItemId,n[i].seq=a[o].info.seq,1==a[o].check_ok?n[i].result=1:0==a[o].check_ok&&(n[i].result=3));e.Items=n,console.log(e.Items)},errList:function(t){console.log(2222),console.log(t)},showModalBtn:function(t){var e=this;2==t?(e.modal_show=!1,"submit"==e.submit_status?(e.doSave(),e.CreateIqcSamples()):"change"==e.submit_status&&(e.doChange(),e.UpdateIqcSamples())):1==t?(e.modal_index+=1,e.modal_num-=1,"submit"==e.submit_status?e.IncomingQualityInspectionBPlusModal_data_show=e.IncomingQualityInspectionBPlusModal_data[e.modal_index]:"change"==e.submit_status&&e.changeShowModalData()):0==t&&(e.modal_index-=1,e.modal_num+=1,"submit"==e.submit_status?e.IncomingQualityInspectionBPlusModal_data_show=e.IncomingQualityInspectionBPlusModal_data[e.modal_index]:"change"==e.submit_status&&e.changeShowModalData())}}),onLoad:function(){var e=this,a="";11==e.qcLevel?a=e.i18n.page_title_a:12==e.qcLevel?a=e.i18n.page_title_b:21==e.qcLevel?a=e.i18n.page_title_c:22==e.qcLevel&&(a=e.i18n.page_title_d),t.setNavigationBarTitle({title:a}),e.rejectQtyStand>e.ngQty||e.rejectQtyStand==e.ngQty?e.QCResult=1:e.QCResult=3,e.GetMaterialCheckItems(),e.default_result=t.getStorageSync("qualityInspection_data").qcResult}};e.default=_}).call(this,a("6e42")["default"])},ff97:function(t,e,a){"use strict";a.r(e);var n=a("e907"),o=a("a0bc");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("3907");var s=a("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports}},[["0509","common/runtime","common/vendor"]]]);